## 基本说明

本项目需要在Bot项目中新起一个子模块，类似Game模块，创建一个新的游戏模块，名为Life，目录结构与职责都和Game模块相仿。

Bot项目是一个集成在聊天工具中的机器人项目，所有请求都从newInstructDistributeController的weChatDeal进入，再通过消息内容判断要调用的功能，需要先了解这块的处理逻辑，便于后续开发。

Life模块的所有返回内容均以图片的形式，准备一张背景图，所有返回的文字都写在背景图上返回，需要注意排版和编码的问题，不要出现乱码，尽量美观，控制合成速度和图片大小，这个图片支持我后期自行更换。

需要自行进行表设计，使用的数据库是Mysql，所有的表均以life_开头，建议开始设计前先参考Game模块的表设计思路，设计开发结束之后生成数据库初始化sql，便于部署测试。

项目没有redis，并发也不会很高，数据都存在数据库，必要时可以做内存缓存（其他模块就是这么做的）。

因为内容比较多，需要完全了解需求之后，做好整体的代码设计再编码，例如战斗的实现，应该是一个通用的方法。

因为是文字游戏，游戏中所有的操作提示需要用『』标出，且用颜色做区分，另外涉及到获得的物品、完成成就之类的关键字需要用颜色作区分，你可以自行设计相关的展示。

另外当你清楚我的目的之后，设计上有些地方可能我没有考虑到的，也需要你自行完善一下。

## 背景

## 基础设定

游戏玩法以人物养成为主的回合制文字战斗游戏，通过一些成就、称号、道具等内容的收集来增加游戏乐趣。

### 属性

人物属性包括：速度，体质，灵力，力量四大基础属性，还有血量、防御、会心、会心效果、破防、攻击力六大拓展属性，拓展属性也可以称作战斗属性，是每次战斗时需要用来计算的属性，每次升级都会增加基础属性，基础属性影响拓展属性。

其中会心、会心效果、破防三个属性的单位是百分号，其他都是纯数值。

每个角色基础属性的初始值都是1，血量初始为10点，防御初始为1点，会心为0%，会心效果为110%，破防为0%，攻击力为6点。

速度决定出手顺序，速度越高，在战斗中越先出手，并且每增加1点速度，破防随之增加0.005%（这个值支持配置）。

每增加1点体质，血量随之增加10点（支持配置），防御随之增加1点（支持配置）。

每增加1点灵力，会心增加0.01%（支持配置），会心效果增加0.005%（支持配置）。

每增加1点攻击，攻击力增加6点（支持配置），破防增加0.01%（支持配置）。

游戏人物有属性之分，共有五种属性，分别是金木水火土。

属性之间存在克制关系：金克木，木克土，土克水，水克火，火克金。

所有对克制属性目标的攻击，最终伤害增加20%（支持配置），与被克制的目标战斗时，自身防御力降低10%（支持配置）

游戏中的技能分为三大类（代码考虑优雅实现）：

直接伤害类，例如：xxx火系技能，造成2.5倍伤害；xxx金系技能，造成3.5倍伤害，该伤害不可会心。

增益类，例如：xxx火系技能，自身和队友速度提高10点，持续2回合；xxx水系技能，立即恢复等同于攻击力的生命值，并且产生持续恢复的效果，效果持续2回合，每回合恢复量削减50%。

减益类，例如：xxx土系技能，限制目标不能使用技能，持续2回合；xxx木系技能，让目标每回合扣除生命值（施法者生命值 * 2%），效果持续3回合，每回合伤害削减50%。

实现战斗功能的时候，要考虑各类技能的生效时机，可能是回合开始前或者回合开始后，要考虑好库表设计时这块的字段怎么设计，以便我后续能快速方便的设计技能。

### 角色装备

角色可以装备一本功法、三本心法、三个神通、一件法宝。

功法：提供修炼速度和少量属性，默认修炼速度是+10修为/分钟，功法的作用主要是在此基础上提供更快的修炼速度，类似于其他游戏的经验条，我们这个游戏即使离线也在增加修为。功法分为有属性和无属性两大类，有属性的功法仅属性相同的角色才能装备，无属性的所有人都可以用。

心法：提供基础属性加成，更换或移除心法时要记得同步修改。心法分为有属性和无属性两大类，有属性的心法仅属性相同的角色才能装备，无属性的所有人都可以用。

神通：战斗中可使用的技能，神通也分有属性和无属性。

法宝：按百分比增加拓展属性（即在基础属性生成拓展属性之后，再计算法宝加成），一个法宝可能增加多个属性，移除或更换时要同步调整属性。法宝也分有属性和无属性。法宝有熟练度的设定，也就是法宝自己的经验条，佩戴法宝之后每次战斗会+1点熟练度，也支持使用道具快速增加，要能支持我配置每个法宝每个等级的属性，当法宝达到我配置的最大等级后就不再增加熟练度。

### 地图与NPC设定

游戏需要包含多张地图，每个地图有固定或随机的NPC和怪物，也就是说你要支持我在数据库配置地图和NPC，NPC可以配置在哪个地图，也可以配置为随机地图。

地图：地图分为可直接传送和内置地图，可直接传送地图是在用户选择传送功能的时候直接作为可选项展示的，内置地图是程序上有这个地图，但用户无法直接访问，需要通过特定入口或者NPC进入，例如一些副本就是内置地图。每个地图要支持我配置进入的最低境界，例如某个地图的怪物比较强，我会配置只有达到金丹境界才能进入等等。

NPC：NPC的功能主要有三个，分别是对话领取道具、传送到指定地图、对话尝试触发奇遇成就。

怪物：玩家在地图可以选择游历，从而遭遇此地图的特定怪物，怪物和副本BOSS以及世界BOSS等所有pve玩法的敌对目标，战斗操作都是程序自行控制的，怪物的战斗属性和神通都支持我配置，只要有技能就用，没技能就随机目标普通攻击，怪物和BOSS所在的地图、各项属性、掉落物品（支持道具、灵粹、功法随机掉落，能各自单独配置掉率）都要支持配置。

### 成就与奇遇设定

成就和奇遇的区别在于，成就是达到一定要求后必定触发，且能获得一定奖励。奇遇是需要完成指定动作，但不一定触发，一旦触发能获得更加丰厚的奖励。

需要支持我在数据库配置成就和奇遇的要求、奖励。

成就：例如达到金丹境界，完成成就【结丹】，获得称号【金丹上人】。

成就的触发条件均与角色自身有关，例如速度达到 1000、力量达到1000等等。

成就的奖励支持三类：称号、道具、灵粹。（可同时包含多类）

奇遇：例如，通关指定副本，有几率触发奇遇【红尘奇缘】，获得称号【红尘】。

奇遇的触发条件与角色日常行为有关，包括通关指定副本、参与击杀世界BOSS、添加好友、与某个指定NPC对话。

奇遇的奖励与成就相同。

### 体力值

每个角色都有自己的体力值，角色在游戏过程中参与战斗即会消耗体力，每个角色体力上限为100，当体力不满时，每5分钟自动恢复1点。

### 道具与货币

游戏货币统一称为灵粹。

游戏道具包含几个大类：

修为类：直接增加修为，例如【小修为丹】，服用立即获得50000修为；

属性类：直接增加某项属性，例如【大力丸】，服用永久增加1点力量；（此类道具需要限制每个角色的使用次数，例如每个角色只能吃10颗大力丸，该限制的次数支持配置）；

体力类：增加角色体力，例如【大还丹】，服用立即恢复10点体力。

升级法宝类：增加当前装备法宝的熟练度，例如【灵器合意散】，使用后增加当前装备法宝20点熟练度。

恢复类：恢复生命值，例如【回春丹】，服用恢复100血量，支持在战斗中使用。

游戏道具获取途径为怪物、BOSS掉落，游戏内商店购买，购买消耗灵粹。

注意，角色装备的功法、心法、神通、法宝也属于道具，支持掉落但不支持购买。

### 好友与邮件系统

游戏内支持通过昵称搜索添加好友，当对方同意好友申请后即双方成为好友，好友之间可以互发邮件，邮件包含主题、内容、附件三要素，附件可以是任意游戏道具，但不能是灵粹。

### 世界BOSS

世界BOSS为指定时间段所有人到指定地点，均可挑战的BOSS，每人挑战后按自己对世界BOSS造成的伤害即时结算奖励。需要支持提前配置多个世界BOSS的属性（战斗属性）、神通、装备分段奖励内容，也要支持配置世界BOSS刷新的时间以及每人每次BOSS可挑战的次数。

例如，我配置了世界BOSS的挑战时间是11:00-12:00，出现地点是地图xxx，那么到11:00的时候，就会随机一个配置好的世界BOSS到该地图，玩家前往该地图游历就能看到挑战世界BOSS的指令，从而进行挑战，假如我提前配置的奖励为0-10000伤害奖励是100灵粹和1颗大还丹，10001-20000伤害奖励是200灵粹和2颗大还丹和1颗小修为丹，那当某个玩家挑战世界BOSS造成了15000伤害，那么他就能获取第二档的奖励。

### 组队机制

由于是文字游戏，组队不能够实时展示，所以我们的组队做的简单一点，仅副本支持组队，且一个队伍最多2个人。

一个人进入副本所在地图，作为队长操作创建队伍，这时其他所有在当前地图的未处于组队状态的玩家都能看到这个队伍可以申请加入，需要队长同意后方可入队，入队后由队长操作挑战副本，战斗中队员的行动由程序托管，在队伍解散或队长离开当前副本之前，队员将不能进行任何操作。

### 副本机制

副本就是我们的内置地图，玩家进入探索即视为挑战副本，每个副本一个BOSS，可以单人挑战也可以组队挑战，每个副本每人每天挑战的次数是有限的，该次数支持配置，副本BOSS的掉落和游历的怪物一样是支持多种物品随机的，每种物品的掉率也是我单独配置，如果是组队的，两个人获得的物品一致。

### 战斗

战斗每个回合可以选择普通攻击、使用技能、防御、使用道具：

普通攻击：首先根据会心几率判断当前攻击能不能会心，如果可以，后面公式中的自身攻击力需要 * 会心效果，普通攻击的伤害计算公式为：自身攻击力 * 系数% - 目标防御 * （ 100% - 自身破防） = 最终伤害（系数可配置，默认是100），其中自身破防最高可生效的值为30%，超过30%按30%算（这个值可配置）。

每回合自行决定怎么操作，除了世界BOSS以外，还提供逃跑选项。

逃跑：当自己的速度高于对方，必定逃跑成功，当自己的速度低于对方，初始逃跑成功率降为50%，且速度每比对方低10点，逃跑成功率下降2%。

## 功能列表

### 进入游戏

收到游戏名"浮生卷"三个字触发游戏模式，进入预备游戏模式状态，发送提示告知用户已经进入游戏模式，游戏模式中收到的所有指令均视为游戏指令，机器人其他功能会失效，如果需要退出可以在游戏模式中随时发送"退出"来返回正常使用模式，此时用户可以发送"1"来正式进入游戏模式，发送其他任意内容视为返回，退出预备状态。

正式进入游戏模式之后，发送当前公告（公告内容支持配置）和当前角色状态，如果没有角色，提示引导用户创建角色，创建角色需要包含昵称、选择的派系，昵称仅支持中文，且不超过7个字，不允许重复；派系支持选择金木水火土。创建角色时应给予派系特色的提示，参考如下：

金：以强大的破坏力闻名，擅长一力破万法，攻击力5星，防御力2星，养成难度4星。

木：拥有强大的恢复能力，治疗和用毒都是一绝，攻击力3星，防御力4星，养成难度3星。

水：流水不争先但滔滔不绝，水以包容为主，各个领域都有涉及，攻击力4星，防御力4星，养成难度4星。

火：擅长持续造成伤害，也拥有可观的爆发力，攻击力4星，防御力3星，养成难度3星。

土：能为自己和队友提供超强的防御，也有不俗的控制能力，攻击力3星，防御力5星，养成难度5星。

如果已经存在角色，则展示当前角色简略状态，需要包含：昵称、当前境界、当前修为、所在地图。

### 通用功能列表

进入游戏后需要展示当前所在地图、可交互的NPC、游历、传送选项。

玩家选择NPC：触发NPC指定内容

游历：随机挑战当前地图的怪物，不论是否逃跑，均扣除1点体

传送：前往其他地图

除了在战斗中，任何时候都提供查看角色信息、查看背包和使用道具的操作，提供鬼市快捷入口。

### 鬼市

一个特殊的地图，内置一个神秘商人NPC，配置了可以直售的道具都能在这里买到，允许我配置初始价格，每天0点会基于初始价格刷新折扣，折扣区间在6-9折。

玩家在这里有个摆摊的选项，选择摆摊之后需要输入摊位名以及要上架的物品、数量、单价，其他玩家可以在这个地图看到所有玩家的摊位，允许使用灵粹自由买卖所有物品，包括功法、法宝、心法、神通。

玩家的所有物品也可以卖给神秘商人，不过价格均为我配置初始价格的2折。

## 其他说明

请你充分考虑交互体验，自行补充完善设计进行开发，做好数据表和定时任务的设计，开发完成后生成一个可执行的初始化sql脚本和操作手册给我，谢谢。


## 第一次测试补充的内容
1.技能不应该直接学习，获取技能的流程应该是通过击败怪物或者BOSS获得技能书到背包，再从背包中使用技能书学习，你要检查下现在的代码是否支持掉落技能书，另外还要注意判断，只能学习相同属性或者无属性的技能书，并且已经学会的技能不可以再次学习；
2.增加一个签到的功能，签到随机获得1-100灵粹，并且每个玩家每天只能签到一次；
3.初始灵粹为空时展示的是null，需要调整为0；
4.我去到鬼市之后，可用操作已经改变，此时我输入1应该是访问神秘商人商店，但结果还是按主界面的逻辑访问到了角色信息；
5.每个页面上方都应该有当前角色的基本状态，包括角色姓名、当前境界、所在地图、当前血量、修行速度；
6.角色属性展示的时候只保留两位小数，超出的部分舍弃；
7.当我发送战斗时，并未进入战斗，而是直接返回了首页，应该实现战斗逻辑；
8.展示修为时，应该同时展示当前境界最大修为，如100/10000；
9.遇到NPC时提示NPC系统未实现，需要完善。

## 第二次测试补充的内容
1.我注意到你的设计中角色除了境界以外还有等级的设定，那有没有设计等级提升的机制呢？要怎么升级？另外如果有等级，角色信息中也应该展示出来；
2.我去了鬼市，但我查看主菜单时，我的位置还是在新手村，没有按照预期改变；
3.当前主菜单的可用操作已经非常多了，底部的内容已经超出了限制，改为多列展示，每列最多8个；
4.现在当用户发送未知指令时都默认展示主菜单了，这个比较奇怪，例如我遭遇了怪物选择进行战斗时，应该进入战斗模式，在分出胜负或者成功逃跑之前都不应该支持其他操作，现在相当于不论什么时候我都能发送任意指令回到主菜单，这个是不合理的，应该指定"菜单"/"返回"等指令来返回主菜单，另外设计专门战斗模式，如果身处战斗模式，就必须完成战斗才能进行其他操作；
5.我在游历探索时遇到怪物，程序提示我可以选择"战斗"或者"逃跑"，但我选择战斗时并未真正触发战斗，是不是还没实现？如果是请完善，如果不是请修复；
6.签到的指令数字调整为0；
7.按照之前的需求文档，组队是在副本地图才有的功能，不应该在主菜单展示，另外确认一下到底有没有实现副本和组队的功能？现在我访问组队功能有报错23:09:42.583 [http-nio-9091-exec-3] INFO  com.bot.boot.controller.newInstructDistributeController-88 -- 收到来自[wxid_gt9s4k14zz7l22]的私聊消息：[10] --
23:09:43.078 [http-nio-9091-exec-3] ERROR com.bot.base.service.impl.DistributorServiceImpl-120 -- 目标[wxid_gt9s4k14zz7l22],响应异常 --
org.springframework.jdbc.BadSqlGrammarException:
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 'member_status' in 'field list'
### The error may exist in URL [jar:file:/data/project/bot/Boot-1.5.0.0.jar!/BOOT-INF/lib/Life-1.5.0.0.jar!/mapper/LifeTeamMemberMapper.xml]
### The error may involve com.bot.life.dao.mapper.LifeTeamMemberMapper.selectByPlayerId-Inline
### The error occurred while setting parameters
### SQL: select            id, team_id, player_id, member_status, join_time         from life_team_member     where player_id = ? and member_status = 1
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 'member_status' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 'member_status' in 'field list'

## 第三次测试的补充内容
1.查看角色信息内容超出了图片范围，基础属性和战斗属性调整为并排展示；
2.战斗时选择逃跑后显示的内容有误，应该展示逃跑结果，现在展示的是一个图片地址；
3.战斗时，每回合玩家操作之后怪物或BOSS应该自动行动，现在只有玩家行动，回合无法进行下去；
4.怪物和BOSS也要有属性并且展示出来，让我更方便的测试伤害计算是否正确；
5.目前很多界面没有下一步的操作指引，例如注册成功、签到成功等，需要完善；
6.主菜单的指令上下的线框换行了，影响展示；
7.各个界面置顶的角色信息上面还有比较多的空白，可以上移一些，字体可以稍微小一点，颜色改为蓝色，把所在地图和血量也放上去和其他信息放在同一行，字体和颜色也与境界修为等保持一致。

## 第四次测试的补充内容
1.每个页面置顶的角色简略信息现在换行了，字体可以调小一些，另外可以网上移一些，上面还有很多空位，颜色调整为普通颜色，不用标红；
2.查看角色信息的时候基础属性和战斗属性表格很不美观，并且仍有内容超出了图片范围，如体力已经展示到图片外了，需要重新设计优化下展示；
3.签到获得了灵粹，但到鬼市显示我的灵粹仍为0；
4.鬼市访问神秘商人商店时报错09:41:17.064 [http-nio-9091-exec-10] INFO  com.bot.boot.controller.newInstructDistributeController-88 -- 收到来自[wxid_gt9s4k14zz7l22]的私聊消息：[1] --
09:41:17.467 [http-nio-9091-exec-10] ERROR com.bot.base.service.impl.DistributorServiceImpl-120 -- 目标[wxid_gt9s4k14zz7l22],响应异常 --
org.apache.ibatis.binding.BindingException: Invalid bound statement (not found): com.bot.life.dao.mapper.LifeShopMapper.selectAll
5.背包中也应该展示当前灵粹数量，现在没有；
6.战斗的文字内容远远超出了图片范围，优化一下战斗信息显示，在不减少内容的情况下尽量使用小的空间，同时保持美观。全局的红色重要信息都缩小字体大小，只比普通文字略大一点即可；
7.战斗时选择攻击报错09:46:19.246 [http-nio-9091-exec-4] INFO  com.bot.boot.controller.newInstructDistributeController-88 -- 收到来自[wxid_gt9s4k14zz7l22]的私聊消息：[1] --
09:46:19.849 [http-nio-9091-exec-4] ERROR com.bot.base.service.impl.DistributorServiceImpl-120 -- 目标[wxid_gt9s4k14zz7l22],响应异常 --
java.lang.NullPointerException: null
        at com.bot.life.service.impl.LifeHandlerImpl.performMonsterActionWithCooldown(LifeHandlerImpl.java:1284)
        at com.bot.life.service.impl.LifeHandlerImpl.handleAttack(LifeHandlerImpl.java:1028)
        at com.bot.life.service.impl.LifeHandlerImpl.handleBattleMode(LifeHandlerImpl.java:949)
        at com.bot.life.service.impl.LifeHandlerImpl.play(LifeHandlerImpl.java:141)
        at com.bot.base.service.impl.DistributorServiceImpl.req2Resp(DistributorServiceImpl.java:197)
        at com.bot.base.service.impl.DistributorServiceImpl.doDistributeWithString(DistributorServiceImpl.java:112)
        at com.bot.boot.controller.newInstructDistributeController.weChatDeal(newInstructDistributeController.java:93)
        at sun.reflect.GeneratedMethodAccessor103.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
8.战斗中选择逃跑时报错09:49:12.747 [http-nio-9091-exec-8] INFO  com.bot.boot.controller.newInstructDistributeController-88 -- 收到来自[wxid_gt9s4k14zz7l22]的私聊消息：[5] --
09:49:13.300 [http-nio-9091-exec-8] ERROR com.bot.base.service.impl.DistributorServiceImpl-120 -- 目标[wxid_gt9s4k14zz7l22],响应异常 --
java.lang.NullPointerException: null
        at com.bot.life.service.impl.LifeHandlerImpl.performMonsterActionWithCooldown(LifeHandlerImpl.java:1284)
        at com.bot.life.service.impl.LifeHandlerImpl.handleBattleEscape(LifeHandlerImpl.java:1138)
        at com.bot.life.service.impl.LifeHandlerImpl.handleBattleMode(LifeHandlerImpl.java:965)
        at com.bot.life.service.impl.LifeHandlerImpl.play(LifeHandlerImpl.java:141)
        at com.bot.base.service.impl.DistributorServiceImpl.req2Resp(DistributorServiceImpl.java:197)
        at com.bot.base.service.impl.DistributorServiceImpl.doDistributeWithString(DistributorServiceImpl.java:112)
        at com.bot.boot.controller.newInstructDistributeController.weChatDeal(newInstructDistributeController.java:93)
        at sun.reflect.GeneratedMethodAccessor103.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)

## 第五次测试的补充内容
1. 置顶的角色简略信息不要换行，放在同一行展示；
2. 图片中置顶内容的上方还有很多空白，上面不需要留白，可以整体内容往上移一些；
3. 取消战斗中的强制退出功能，战斗只有分出胜负或者逃跑，不存在强制退出；
4. 增加脱战血量自动回复机制，当血量不满且不处于战斗状态时，每1分钟恢复最大血量的20%，最多恢复到血量上限的血量值；
5. 技能修炼功能中移除可学技能的功能，技能都应该从背包的技能书中学习，这里不需要展示可学技能；
6. 鬼市进入神秘商人商店报错10:44:46.185 [http-nio-9091-exec-8] INFO  com.bot.boot.controller.newInstructDistributeController-88 -- 收到来自[wxid_gt9s4k14zz7l22]的私聊消息：[1] --
10:44:46.742 [http-nio-9091-exec-8] ERROR com.bot.base.service.impl.DistributorServiceImpl-120 -- 目标[wxid_gt9s4k14zz7l22],响应异常 --
org.springframework.jdbc.BadSqlGrammarException:
### Error querying database.  Cause: java.sql.SQLSyntaxErrorException: Unknown column 's.in_stock' in 'field list'
### The error may exist in URL [jar:file:/data/project/bot/Boot-1.5.0.0.jar!/BOOT-INF/lib/Life-1.5.0.0.jar!/mapper/LifeShopMapper.xml]
### The error may involve defaultParameterMap
### The error occurred while setting parameters
### SQL: select          s.id, s.item_id, s.base_price, s.discount, s.current_price, s.in_stock,          s.last_refresh_date, s.create_time, s.update_time,         i.id as item_pk_id, i.name as item_name, i.type as item_type,         i.effect_value as item_effect_value, i.description as item_description     from life_shop s     left join life_item i on s.item_id = i.id     where s.in_stock = 1     order by s.id
### Cause: java.sql.SQLSyntaxErrorException: Unknown column 's.in_stock' in 'field list'
; bad SQL grammar []; nested exception is java.sql.SQLSyntaxErrorException: Unknown column 's.in_stock' in 'field list'
7. 请告诉我现在角色的等级提升和境界提升的途径分别是什么，提升后会带来哪些属性加成？

## 第六次测试的补充内容
1.现在存在第一行文字太靠上的情况，置顶的角色简略信息保持不变，将文本绘制起始Y位置调整为50像素；
2.我注意到道具系统还未实现，请严格按照本文档上面的设计，实现道具系统，游历中获取的道具也实时添加到背包中；
3.当我选择地图传送1到新手村的时候，实际触发了主菜单查看角色信息的功能，这与预期不符，请修复这块逻辑，不止是针对新手村，后续增加新的地图也要能支持传送，各类菜单是否都正常加载了？
4.进入神秘人商店之后，出售商品较多时内容会超出限制，建议只展示物品名称和价格，选择具体物品之后再展示物品详情并支持批量购买，购买时需要校验灵粹是否足够，购买后物品添加到背包，扣除对应的灵粹；
5.存在报错11:45:39.750 [http-nio-9091-exec-10] INFO  com.bot.boot.controller.newInstructDistributeController-88 -- 收到来自[wxid_gt9s4k14zz7l22]的私聊消息：[2] --
11:45:40.216 [http-nio-9091-exec-10] ERROR com.bot.base.service.impl.DistributorServiceImpl-120 -- 目标[wxid_gt9s4k14zz7l22],响应异常 --
org.apache.ibatis.binding.BindingException: Invalid bound statement (not found): com.bot.life.dao.mapper.LifePlayerStallMapper.selectAll
6.在鬼市交易增加提示：可发送返回回到上一菜单；
7.战斗败北之后没有退出战斗模式，虽然提示了输入任意内容返回，但不论我输入什么都还是在战斗中。